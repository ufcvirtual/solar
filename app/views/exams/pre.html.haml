.exam_pre
  .title
    #name= @exam.name
    #description= @exam.description

  %table.tb_list{:border => "0", :cellpadding => "0", :cellspacing => "0", :width => "100%"}
    %tbody
      %tr.lines
        %td= t("exams.pre.duration")
        %td=  (@exam.duration-@total_time/60).to_s + t("exams.pre.min")
      %tr.lines
        %td= t("exams.pre.questions")
        %td= @exam.number_questions.to_s
      %tr.lines
        %td= t("exams.pre.attempts")
        %td=  @total_attempts.to_s + t("exams.pre.of") +  @exam.attempts.to_s
      %tr.lines
        %td= t("exams.pre.block")
        - block_content = @exam.block_content ? t("exams.pre.aw_yes") : t("exams.pre.aw_no")
        %td= block_content
      %tr.lines
        %td= t("exams.pre.uninterrupted")
        - uninterrupted = @exam.uninterrupted ? t("exams.pre.aw_no") : t("exams.pre.aw_yes")
        %td= uninterrupted


  .notice
    #save= t("exams.pre.alert_save")
    #start= t("exams.pre.alert_start")

  .start_button
    = link_to t("exams.pre.button"), open_exam_path(@exam, situation: @situation), :'data-tooltip' => "exam.name", class: 'link_content link_open_exam', id: 'open-exam'
    
:javascript

    $(".link_open_exam").call_fancybox({
      minWidth: '50%',
      minheigth: '50%',
      closeBtn : !#{@exam.uninterrupted},
      height: 'auto',
      afterShow: function() {
        if (!#{@exam.uninterrupted}) {
          window.onbeforeunload = function () {}
        }
      },
      beforeClose: function() {
        if (#{@exam.uninterrupted}) {
          var resp = window.confirm("#{I18n.t('exams.open.refresh')}");
          if (resp) {
            window.onbeforeunload = function () {}
          }
          else {return resp }
        }
        else{ window.onbeforeunload = function () {} }
      }
    });
