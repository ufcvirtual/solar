%section.webconference
  .block_title
    %h2= t(:webconference, :scope => [:scores, :info])
    .tabs.tab_web
      %ul
        %li= link_to t(:evaluative, scope: [:scores, :info]), '#', class: 'evaluative active', onclick: 'change_tab_tool(this); return false;', :'data-div' => '#evaluative_web', onkeydown: 'click_on_keypress(event, this);'
        %li= link_to t(:frequency, scope: [:scores, :info]), '#', class: 'frequency', onclick: 'change_tab_tool(this); return false;', :'data-div' => "#frequency_web", onkeydown: 'click_on_keypress(event, this);'
        %li= link_to t(:not_evaluative, scope: [:scores, :info]), '#', class: 'notevaluative', onclick: 'change_tab_tool(this); return false;', :'data-div' => "#notevaluative_web", onkeydown: 'click_on_keypress(event, this);'
  .block_content
    .tools.show#evaluative_web
      - unless @webconferences_evaluative.blank?
        %table.webconferences.tb_list{:summary=> t("webconferences.list.summary_evaluative")}
          %thead
            %tr.lines
              %th#we_eva_nam.default_width.center= t(:name, scope: [:webconferences, :list])
              %th#we_eva_ava.default_width.center= t(:availability, scope: [:webconferences, :list])
              %th#we_eva_sit.smaller_width.center= t(:situation, scope: [:scores, :info])
              - if @is_student
                %th#we_eva_gra.center{style: "width: 2%;"}= t(:grade, :scope => [:scores, :info])
              %th#we_eva_rec.smaller_width.center.no_sort= t(:recording, scope: [:webconferences, :index])
              - if @can_see_access || @can_evaluate
                %th#we_eva_acc.smaller_width.center.no_sort{style: "width: 2%;"}
              - if @is_student
                %th#we_eva_aft.center.no_sort{style: "width: 2%;"}=t('scores.info.new_after_evaluation')
          %tbody
            - @webconferences_evaluative.each do |webconference|
              - unavailable = exist_and_offline?(webconference.server.to_i)
              - disabled = (webconference.situation == 'scheduled' || webconference.situation == 'in_progress' || webconference.situation == 'processing' || unavailable)
              %tr.lines
                %td.webconference_access.title{ :'data-url' => access_webconference_path(webconference.academic_tool_id, at_id: webconference.allocation_tag_id), headers: "we_eva_nam" }
                  - if (webconference.opened == 't' && webconference.closed == 'f') 
                    = link_to_function(webconference.name, 'access_webconference(this)') 
                  - else
                    .title= webconference.name
                  .description
                    .minimun= sanitize(truncate webconference.description, length: 100, omission: "#{content_tag(:i, nil, class: 'expand icon-ellipsis', :"data-tooltip" => t(".expand_description"))}")
                    .complete.invisible
                      = webconference.description
                      = content_tag(:i, nil, class: "compress icon-arrow-up-triangle", :"data-tooltip" => t(".compress_description"))
                  .equivalent
                    - unless webconference.eq_name.blank?
                      %a{ href: '#', :"data-dropdown" => "#dropdown_eq_1_#{webconference.id}", onkeydown: 'click_on_keypress(event, this);' }
                        %i.icon-flow-parallel
                        = t('scores.info.equivalency')
                        %i.icon-arrow-down-triangle
                      .dropdown.dropdown-tip{id: "dropdown_eq_1_#{webconference.id}"}
                        %ul{ class: 'dropdown-menu' }
                          = raw t('scores.info.equivalent', name: webconference.eq_name)
                    - else
                      %a{ href: '#', :"data-dropdown" => "#dropdown_eq_1_#{webconference.id}", :'data-url' => equalities_tools_path(tool_type: webconference.academic_tool_type, ac_id: webconference.id), onclick: 'open_dropdown(this);', onkeydown: 'click_on_keypress(event, this);' }
                        %i.icon-flow-parallel
                        =t('scores.info.equalities')
                        %i.icon-arrow-down-triangle
                      .dropdown.dropdown-tip{id: "dropdown_eq_1_#{webconference.id}"}
                        %ul{ class: 'dropdown-menu' }
                %td.center{headers: "we_eva_ava"}
                  %div= l(webconference.start_date.to_date, format: :normal)
                  %div= [l(webconference.start_hour.to_time, format: :today), l(webconference.end_hour.to_time, format: :today)].join(' - ')
                %td.center{class: (unavailable ? 'assignment_not_started' : "assignment_#{webconference.situation}"), headers: "we_eva_sit"}= unavailable ? t(:unavailable, scope: [:webconferences, :list]) : t("scores.situation.#{webconference.situation}")
                - if @is_student
                  %td.center{headers: "we_eva_gra"}= webconference.grade
                - if disabled
                  %td.center{:'data-tooltip' => t('webconferences.list.watch'), headers: "we_eva_rec"}= link_to content_tag(:i, nil, class: 'icon-play btn disabled'), '#', disabled: true, onclick: 'return false', :'aria-label' => t('webconferences.list.watch')
                - else
                  %td.center{:'data-tooltip' => t('webconferences.list.watch'), headers: "we_eva_rec"}= link_to content_tag(:i, nil, class: 'icon-play btn'), get_record_webconference_path(webconference.academic_tool_id, at_id: webconference.allocation_tag_id), class: "record", onkeydown: 'click_on_keypress(event, this);', :'aria-label' => t('webconferences.list.watch')
                - if @can_see_access || @can_evaluate
                  %td.center{ :'data-url' => list_access_webconference_path(webconference.academic_tool_id, at_id: webconference.allocation_tag_id, user_id: @user.id), :'data-tooltip' => t(:to_evaluate, scope: [:posts, :post]), headers: "we_eva_acc" }= link_to_function content_tag(:i, nil, class: "icon-#{@can_evaluate && @is_student ? 'write' : 'users'} btn"), 'list_access(this)', onkeydown: 'click_on_keypress(event, this);', :'aria-label' => t(:to_evaluate, scope: [:posts, :post])
                - if @is_student
                  %td.center{headers: "we_eva_aft"}=(webconference.new_after_evaluation == 't' ? t('scores.info.new_yes') : t('scores.info.new_no'))
                  
      - else
        .block_content.block_content_text= t(:no_data, scope: [:webconferences, :list])

    .tools#frequency_web
      - unless @webconferences_frequency.blank?
        %table.webconferences.tb_list{:summary=> t("webconferences.list.summary_frequency")}
          %thead
            %tr.lines
              %th#we_fre_nam.default_width.center= t(:name, scope: [:webconferences, :list])
              %th#we_fre_ava.default_width.center= t(:availability, scope: [:webconferences, :list])
              %th#we_fre_sit.smaller_width.center= t(:situation, scope: [:webconferences, :list])
              - if @is_student
                %th#we_fre_fre.center{style: "width: 2%;"}= t(:frequency, :scope => [:scores, :info])
              %th#we_fre_rec.smaller_width.center.no_sort= t(:recording, scope: [:webconferences, :index])
              - if @can_see_access || @can_evaluate
                %th#we_fre_acc.smaller_width.center.no_sort{style: "width: 2%;"}
              - if @is_student
                %th#we_fre_aft.center.no_sort{style: "width: 2%;"}=t('scores.info.new_after_evaluation')
          %tbody
            - @webconferences_frequency.each do |webconference|
              - unavailable = exist_and_offline?(webconference.server.to_i)
              - disabled = (webconference.situation == 'scheduled' || webconference.situation == 'in_progress' || webconference.situation == 'processing' || unavailable)
              %tr.lines
                %td.webconference_access{ :'data-url' => access_webconference_path(webconference.academic_tool_id, at_id: webconference.allocation_tag_id), headers: "we_fre_nam" }
                  - if (webconference.opened == 't' && webconference.closed == 'f') 
                    = link_to_function(webconference.name, 'access_webconference(this)') 
                  - else
                    .title= webconference.name
                  .description
                    .minimun= sanitize(truncate webconference.description, length: 100, omission: "#{content_tag(:i, nil, class: 'expand icon-ellipsis', :"data-tooltip" => t(".expand_description"))}")
                    .complete.invisible
                      = webconference.description
                      = content_tag(:i, nil, class: "compress icon-arrow-up-triangle", :"data-tooltip" => t(".compress_description"))
                  .equivalent
                    - unless webconference.eq_name.blank?
                      %a{ href: '#', :"data-dropdown" => "#dropdown_eq_2_#{webconference.id}", onkeydown: 'click_on_keypress(event, this);' }
                        %i.icon-flow-parallel
                        = t('scores.info.equivalency')
                        %i.icon-arrow-down-triangle
                      .dropdown.dropdown-tip{id: "dropdown_eq_2_#{webconference.id}"}
                        %ul{ class: 'dropdown-menu' }
                          = raw t('scores.info.equivalent', name: webconference.eq_name)
                    - else
                      %a{ href: '#', :"data-dropdown" => "#dropdown_eq_2_#{webconference.id}", :'data-url' => equalities_tools_path(tool_type: webconference.academic_tool_type, ac_id: webconference.id), onclick: 'open_dropdown(this);', onkeydown: 'click_on_keypress(event, this);' }
                        %i.icon-flow-parallel
                        =t('scores.info.equalities')
                        %i.icon-arrow-down-triangle
                      .dropdown.dropdown-tip{id: "dropdown_eq_2_#{webconference.id}"}
                        %ul{ class: 'dropdown-menu' }
                %td.center{headers: "we_fre_ava"}
                  %div= l(webconference.start_date.to_date, format: :normal)
                  %div= [l(webconference.start_hour.to_time, format: :today), l(webconference.end_hour.to_time, format: :today)].join(' - ')
                %td.center{class: (unavailable ? 'assignment_not_started' : "assignment_#{webconference.situation}"), headers: "we_fre_sit"}= unavailable ? t(:unavailable, scope: [:webconferences, :list]) : t("scores.situation.#{webconference.situation}")
                - if @is_student
                  %td.center{headers: "we_fre_fre"}= webconference.working_hours
                - if disabled
                  %td.center{:'data-tooltip' => t('webconferences.list.watch'), headers: "we_fre_rec"}= link_to content_tag(:i, nil, class: 'icon-play btn disabled'), '#', disabled: true, onclick: 'return false', :'aria-label' => t('webconferences.list.watch')
                - else
                  %td.center{:'data-tooltip' => t('webconferences.list.watch'), headers: "we_fre_rec"}= link_to content_tag(:i, nil, class: 'icon-play btn'), get_record_webconference_path(webconference.academic_tool_id, at_id: webconference.allocation_tag_id), class: "record", onkeydown: 'click_on_keypress(event, this);', :'aria-label' => t('webconferences.list.watch')
                - if @can_see_access || @can_evaluate
                  %td.center{ :'data-url' => list_access_webconference_path(webconference.academic_tool_id, at_id: webconference.allocation_tag_id, user_id: @user.id), :'data-tooltip' => t(:to_evaluate, scope: [:posts, :post]), headers: "we_fre_acc" }= link_to_function content_tag(:i, nil, class: "icon-#{@can_evaluate && @is_student ? 'write' : 'users'} btn"), 'list_access(this)', onkeydown: 'click_on_keypress(event, this);', :'aria-label' => t(:to_evaluate, scope: [:posts, :post])
                - if @is_student
                  %td.center{headers: "we_fre_aft"}=(webconference.new_after_evaluation == 't' ? t('scores.info.new_yes') : t('scores.info.new_no'))
                  
      - else
        .block_content.block_content_text= t(:no_data, scope: [:webconferences, :list])
    
    .tools#notevaluative_web 
      - unless @webconferences_not_evaluative.blank?
        %table.webconferences.tb_list{:summary=> t("webconferences.list.summary_notevaluative")}
          %thead
            %tr.lines
              %th#we_not_nam.default_width.center= t(:name, scope: [:webconferences, :list])
              %th#we_not_ava.default_width.center= t(:availability, scope: [:webconferences, :list])
              %th#we_not_sta.smaller_width.center= t(:status, scope: [:webconferences, :list])
              %th#we_not_rec.smaller_width.center.no_sort= t(:recording, scope: [:webconferences, :index])
              - if @can_see_access
                %th#we_not_acc.center.no_sort{style: 'width: 2%;'}= t('webconferences.index.access')
          %tbody
            - @webconferences_not_evaluative.each do |webconference|
              - unavailable = exist_and_offline?(webconference.server.to_i)
              - disabled = (webconference.situation == 'scheduled' || webconference.situation == 'in_progress' || webconference.situation == 'processing' || unavailable)
              %tr.lines
                %td.webconference_access{ :'data-url' => access_webconference_path(webconference.academic_tool_id, at_id: webconference.allocation_tag_id), headers: "we_not_nam" }
                  - if (webconference.opened == 't' && webconference.closed == 'f') 
                    = link_to_function(webconference.name, 'access_webconference(this)') 
                  - else
                    .title= webconference.name
                  .description
                    .minimun= sanitize(truncate webconference.description, length: 100, omission: "#{content_tag(:i, nil, class: 'expand icon-ellipsis', :"data-tooltip" => t(".expand_description"))}")
                    .complete.invisible
                      = webconference.description
                      = content_tag(:i, nil, class: "compress icon-arrow-up-triangle", :"data-tooltip" => t(".compress_description"))
                  .equivalent
                    - unless webconference.eq_name.blank?
                      %a{ href: '#', :"data-dropdown" => "#dropdown_eq_3_#{webconference.id}", onkeydown: 'click_on_keypress(event, this);' }
                        %i.icon-flow-parallel
                        = t('scores.info.equivalency')
                        %i.icon-arrow-down-triangle
                      .dropdown.dropdown-tip{id: "dropdown_eq_3_#{webconference.id}"}
                        %ul{ class: 'dropdown-menu' }
                          = raw t('scores.info.equivalent', name: webconference.eq_name)
                    - else
                      %a{ href: '#', :"data-dropdown" => "#dropdown_eq_3_#{webconference.id}", :'data-url' => equalities_tools_path(tool_type: webconference.academic_tool_type, ac_id: webconference.id), onclick: 'open_dropdown(this);', onkeydown: 'click_on_keypress(event, this);' }
                        %i.icon-flow-parallel
                        =t('scores.info.equalities')
                        %i.icon-arrow-down-triangle
                      .dropdown.dropdown-tip{id: "dropdown_eq_3_#{webconference.id}"}
                        %ul{ class: 'dropdown-menu' }
                %td.center{headers: "we_not_ava"}
                  %div= l(webconference.start_date.to_date, format: :normal)
                  %div= [l(webconference.start_hour.to_time, format: :today), l(webconference.end_hour.to_time, format: :today)].join(' - ')
                %td.center{class: (unavailable ? 'assignment_not_started' : "assignment_#{webconference.situation}"), headers: "we_not_sta"}= unavailable ? t(:unavailable, scope: [:webconferences, :list]) : t("scores.situation.#{webconference.situation}")
                - if disabled
                  %td.center{:'data-tooltip' => t('webconferences.list.watch'), headers: "we_not_rec"}= link_to content_tag(:i, nil, class: 'icon-play btn disabled'), '#', disabled: true, onclick: 'return false', :'aria-label' => t('webconferences.list.watch')
                - else
                  %td.center{:'data-tooltip' => t('webconferences.list.watch'), headers: "we_not_rec"}= link_to content_tag(:i, nil, class: 'icon-play btn'), get_record_webconference_path(webconference.academic_tool_id, at_id: webconference.allocation_tag_id), class: "record", onkeydown: 'click_on_keypress(event, this);', :'aria-label' => t('webconferences.list.watch')
                - if @can_see_access
                  %td.center{ :'data-url' => list_access_webconference_path(webconference.academic_tool_id, at_id: webconference.allocation_tag_id, user_id: @user.id), :'data-tooltip' => t(:to_evaluate, scope: [:posts, :post]), headers: "we_not_acc" }= link_to_function content_tag(:i, nil, class: "icon-users btn"), 'list_access(this)', onkeydown: 'click_on_keypress(event, this);', :'aria-label' => t(:to_evaluate, scope: [:posts, :post])
                
      - else
        .block_content.block_content_text= t(:no_data, scope: [:webconferences, :list])    

= javascript_include_tag 'tooltip', 'webconferences', 'tablesorter', 'scores'

:javascript
  $(function(){
    $('.record').call_fancybox();
  });