.block_wrapper#discussion_list
  - unless @discussions.nil? or @discussions.empty?
    .block_title
      %h2
        %i.icon-forum
        = t(:forum_table_title)
    %table.tb_list{cellpadding:"10", cellspacing:"0", width:"100%", style:"table-layout: fixed"}
      %thead
        %tr.lines
          %th{align:"left"}=t :title
          %th{style:"width: 10%;"}= t(".posts")
          %th.date{align:"center", style:"width: 22%;"}=t :forum_table_date
      %tbody
        - @discussions.each do |discussion|
          - closed, extra_time = discussion.closed?, discussion.extra_time?(current_user.id)
          %tr{class: "lines #{'period_ended' if closed and (not extra_time)} "}
            %td
              - if (discussion.opened? or closed)
                = link_to discussion.name, discussion_posts_path(discussion), {class: 'link_content'}
                = (extra_time ? "(#{t(:discussion_closed_to_students)})" : (closed ? "(#{t(:forum_closed_short)})" : ""))
              - else
                = discussion.name
            %td{align:"center"}= discussion.posts_count
            %td{style: "width: 200px;"}= [l(discussion.start_date.to_date), l(discussion.end_date.to_date)].join(" - ")
  - else
    .block_content.block_content_text= t(:forum_message)

= javascript_include_tag "contextual_help/discussion"